!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var o in s)("object"==typeof exports?exports:t)[o]=s[o]}}(self,(function(){return(()=>{"use strict";var t={d:(e,s)=>{for(var o in s)t.o(s,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:s[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>o});const s={emit:!0,clear:!1};class o{__defaultState;__obs;__state;onSetBefore;onSetAfter;constructor(t){if(t&&"object"!=typeof t)throw Error('new Lipid() "state" argument must be an object.');this.__defaultState=t,this.__obs=new Subject,this.onSetBefore=t=>t,this.onSetAfter=()=>{},this.__state=t||{}}on(t=[]){return this.__obs.pipe(filter((({state:e,prevState:s,delta:o})=>!t||!t.length||!!intersection(t,Object.keys(o)).reduce(((t,o)=>isEqual(e[o],s[o])?t:[...t,o]),[]).length)),map((({state:t,prevState:e,delta:s})=>({state:t,prevState:e}))))}get(t=""){return t?this.__state[t]:this.__state}set(t,e=s){const{clear:o,emit:r}=e;let n="function"==typeof t?t(this.__state):t;if("object"!=typeof n||null===n)throw new TypeError(`[${this.constructor.name}] "state" argument must be an object`);n=this.onSetBefore(n);const a=Object.assign({},this.__state);return this.__state=o?Object.assign({},n):Object.assign({},this.__state,n),this.onSetAfter(this.__state,n),r&&this.__obs.next({state:this.__state,prevState:a,delta:n}),this.__state}reset(t={}){const{emit:e}=t;return this.set(this.__defaultState,{emit:e,clear:!0})}}return e})()}));